<!doctype html>
<html lang="es">

<head>
  <title>{% block title %}{% endblock title %}</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />

  <!-- SweetAlert2 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.23.0/dist/sweetalert2.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.23.0/dist/sweetalert2.all.min.js"></script>

  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- DataTables CSS -->
  <link href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css" rel="stylesheet">
  <link href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.bootstrap5.min.css" rel="stylesheet">

  <link rel="stylesheet" href="{{ url_for('static', filename='css/estilo.css') }}">
</head>

<body class="bg-success bg-opacity-10">

  <!-- NAVBAR -->
  <header>
    <nav class="navbar navbar-expand-lg bg-body-tertiary" data-bs-theme="dark"
      style="background: linear-gradient(92deg, #000000,#242424,#5f5e5d,#e6e6e6);">
      <div class="container">
        <a class="navbar-brand fw-bold text-light" href="{{ url_for('admin') }}">
          Sistema
        </a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav justify-content-center flex-grow-1">
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('admin') }}">Inicio</a>
            </li>

            <!-- Productos -->
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                aria-expanded="false">Productos</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="{{ url_for('listar_productos_agregados') }}">Agregar</a></li>
                <li><a class="dropdown-item" href="{{ url_for('listar_productos') }}">Listar</a></li>
              </ul>
            </li>

            <!-- Usuarios -->
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('listar') }}">Usuarios</a>
            </li>
          </ul>

          <!-- Mostrar usuario logueado -->
          {% if session.get('nombre') %}
          <span class="navbar-text text-light ms-2 me-3">
            <i class="bi bi-person-circle"></i> {{ session['nombre'] }}
          </span>
          {% endif %}
          <a class="btn btn-outline-danger" id="logoutBtn" href="{{ url_for('logout') }}">SALIR</a>
        </div>
      </div>
    </nav>
  </header>

  <!-- CONTENIDO -->
  <main>
    {% block body %}{% endblock %}
  </main>

  <!-- FOOTER -->
  <footer class="mt-4">
    <div class="container bg-light text-center py-3 shadow-sm">
      © 2025 PulperiaInventario+. Todos los derechos reservados
    </div>
  </footer>

  <!-- JS Libraries -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <!-- DataTables + Buttons -->
  <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.bootstrap5.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.print.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.colVis.min.js"></script>

  <!-- Confirmar logout -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const logoutBtn = document.querySelector('a[href="{{ url_for("logout") }}"]');
      if (logoutBtn) {
        logoutBtn.addEventListener('click', function (e) {
          e.preventDefault();
          Swal.fire({
            title: '¿Está seguro que desea cerrar el sistema?',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonText: 'Sí, cerrar',
            cancelButtonText: 'Cancelar'
          }).then((result) => {
            if (result.isConfirmed) {
              window.location.href = logoutBtn.href;
            }
          });
        });
      }
    });
  </script>

  {% block scripts %}{% endblock %}
</body>
</html>
